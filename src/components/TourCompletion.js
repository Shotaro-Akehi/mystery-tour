import React, { useState, useEffect } from "react";
import "../styles/global.css";

const TourCompletion = ({ destination, price }) => {
  const [destinationInfo, setDestinationInfo] = useState(null);
  const [loading, setLoading] = useState(true);
  const [showDetails, setShowDetails] = useState(false); // 詳細を表示するための状態

  useEffect(() => {
    const fetchDestinationInfo = async () => {
      try {
        // 注意: 実際のAPIエンドポイントに置き換えてください
        const response = await fetch(`https://api.example.com/destination/${destination}`);
        const data = await response.json();
        setDestinationInfo(data);
      } catch (error) {
        console.error("目的地の情報取得に失敗しました:", error);
      } finally {
        setLoading(false);
      }
    };

    fetchDestinationInfo();
  }, [destination]);

  if (loading) {
    return <div className="container fade-in">読み込み中...</div>;
  }

  return (
    <div className="container fade-in">
      <div className="price-display">あなたのお支払い金額は{price.toLocaleString()}円です</div>
      <div className="card">
        <h2>ミステリーツアー完了！</h2>
        <p>おめでとうございます！あなたは無事に目的地に到着しました。</p>
        <h3>目的地: {destination}</h3>
        {destinationInfo && (
          <div>
            <p>{destinationInfo.description}</p>
            <h4>見どころ:</h4>
            <ul>
              {destinationInfo.attractions.map((attraction, index) => (
                <li key={index}>{attraction}</li>
              ))}
            </ul>
          </div>
        )}
        <p className="celebration">素晴らしい冒険でした！新たな発見と思い出を胸に、次なる冒険へ出発しましょう。</p>
      </div>

      {/* 「詳細を見る」ボタンの追加 */}
      <div style={{ marginTop: "20px" }}>
        <button
          className="btn"
          onClick={() => setShowDetails(!showDetails)}
        >
          {showDetails ? "閉じる" : "詳細を見る"}
        </button>
        {showDetails && (
          <p style={{ marginTop: "10px" }}>
            妙立寺（みょうりゅうじ）とは、石川県金沢市にある日蓮宗の寺院。山号は正久山。旧本山は京都立本寺。通称は忍者寺[1]。潮師法縁。

解説
加賀藩第三代藩主前田利常が創建した。複雑な建築構造と外敵を欺く仕掛けから、忍者寺（にんじゃでら）とも呼ばれる。「忍者寺」は本寺院の登録商標（日本第1977891号他、住職の張田珠潮名義）である[2]。

天正13年（1583年）、藩祖前田利家が金沢城に入城すると、政治の理念を日蓮宗・法華経の中道精神に求め、藩を守護する祈願所を建立した[3]。

寛永20年（1643年）、三代藩主利常が金沢城の近くから移築建立する[4][5]。利常は徳川幕府により改易されるのを避けるため、徳川家から嫁を迎えるとともに母親を人質に出し、鼻毛を伸ばして馬鹿殿様を演じることで幕府を欺き安心させる[3]。一方、多くの武士が起居できる寺院群（現在の寺町寺院群）を新築し、その中心に出城の役目を持たせた妙立寺を建立する[3][5]。要塞としての機能を備えた妙立寺は、隠し階段・隠し部屋・落とし穴・見張り台・金沢城へ続く地下通路など外敵を欺く種々な仕掛けを備える[3]。忍者寺と称されるのは、同寺に忍者がいたからではなく、伽藍の複雑な建築構造に由来する。建造は、日蓮の法孫、日像と伝えられる。

戦火を免れた妙立寺は、歴代藩主の祈願所として崇拝される。北陸の豪雪に耐え、その独特の建築様式を現在に伝えている。そこから今の人気スポットとなっている。

堂内は撮影・土足禁止、禁煙で、建物の複雑さと老朽化から、見学は予約制で案内人同伴による団体（集団）見学となる。保存護持費として、大人1200円、子ども800円が要求される[6]。未就学児は見学不可。また、荷物等が当たって建物を損なうことがあるため、背中側におく荷物は持ち込めない。


境内入り口
本堂
当時、幕命で3階建て以上の建物は禁止されていたことにより、外観は2階建てだが、内部は4階建て7層になっている[4]。中2階、中々2階があり、部屋数は23、階段数は29もある[4][3]。

物見台・望楼
本堂の屋根の先端部分にあるギヤマン（現在はガラス）張りの見張り台。加賀平野を遠望でき、敵の動きをいち早く察知できる。金沢城と明かりによる、連絡も可能であった[3]。2階座敷の入って右側にある押入に模した隠し階段の途中にさらに隠し扉があり、そこから出入りが可能。
井戸
戸室山で採れる戸室石を丸ごとくりぬいて作った井戸で、堂の中心部に位置する。戸室石は金沢城の石垣にも使われる、高級な石である。
深さはおよそ25mほど。茶水に利用される。水面上3〜4mには横穴があり、金沢城へ続く逃げ道になったとも云われている。そのため、庫裏の各部屋はこの井戸を中心に構成され、どの部屋からもロープを使い井戸へと逃げることができる。
しかし、当時の技術では犀川を越えて地下通路を掘るのは困難とされ、横穴が金沢城へと続いているかは定かではない。ただし、未だ通行を試みたものがいないため真偽は定かでなく、「伝説の井戸」と呼ばれる。
仕掛け賽銭箱
本堂正面入り口に埋め込まれ、仕掛けにより落とし穴として利用できる[3]。本来、入り口から畳2枚分、深さ2〜3mが落とし穴とされており、先鋒をきる足軽などを落とすことが考えられていた。しかし平時には一般参詣客の危難になると考えられ、奥の一畳分のみが賽銭箱とされている。
太鼓橋
井戸を川（犀川）と見立てて室内に架けられた橋。二階四層目にあたる。橋の上から水を汲み上げお茶を嗜む。天然の一本木をくりぬいて作られている。
茶室
三階に設けられた茶室。本来あってはならない三階目であるため、二階四層目の座敷の隠し階段から上がる。この隠し階段は押入の形をしており、奥にもう一つ本当の押入がある。普段は座布団などを置いて隠したという。向かって右壁の隠し戸から隠し階段に上がれる。茶室はくつろぎの場として、武器を振り回せないように大人一人が立ったくらいの高さで作られており、狭さを感じさせないよう天井は中央の高い弓なりになっている。窓は高い位置に作られており、正座をすると外の景色は見えない。そこで、向かって右の壁に、群青で縁取った富士、その上にたなびく雲を模した左上の違い棚、左を頭にした登り龍に見立てた木の根が飾られており、それを満月に見立てた円で囲んでいる。四階への登り口もあるが、現在は閉鎖されている。
茶の準備室
茶室の次の間にある、茶の湯を準備する間。入って左手の窓の外には二つの木滑車があり、井戸から水を汲み上げる。井戸からの高さはおよそ11m。奥手には武者溜りに降りる階段がある。階段はかなり急で、途中坂になっている場所がある。そこから、切腹の間へ行くことができる。
武者溜り
二階にある、警固の武士の詰所。武器の手入れなどもしやすいよう、天井は高くとられている。押入に見せた三階への階段、床の間に作られた本堂への抜け道、障子の向こうにある一階への螺旋階段、隣室につながる押入のような襖の、計四か所の出入り口がある。床の間の口は左下に作られており、一階の座敷につながっている。本堂からは、座敷の四枚の白襖がみられる。
謁見の間・大名茶室
二階にある豪華な間。最も格式が高く、歴代藩主が専ら用いた。十二代から十四代までの奥方の着物が飾られ、色褪せてはいるものの加賀友禅に三十種余りの日本刺繍を施した豪華な衣裳を見ることができる。右手奥には、五畳半の殿様の茶室、大名（ダイメイ）茶室がある。
明かり取り階段
正面の突き当たりにある階段。蹴込（けこみ）の部分に障子を張って明かりを取り、外敵の足の影を見て槍などで倒すことができる[3]。階段下の奥には下男部屋があり、窓や燈明のない彼らの部屋の光源となっていた。
なお、階段を上がりきると戸があり、戸を開けると廊下に出る。実は廊下側から見て右手には別棟に続く逃げ道があり、追われる者は明り取り階段を上がって戸を開け、廊下に逃げる代わりに右手の逃げ道を使うことができた。追手は廊下に出ようと戸を開けるためその時に逃げ道の戸は閉まり、身を隠すことができた。これは二枚戸という。
落とし穴階段
本堂の階段群にある渡り廊下に見せた階段[3]。本堂から見て左手にある階段の三段目より下があたる。床板をはずすと落とし穴になり、下男部屋へ通じている。この落とし穴に落ちると、階下で待ち伏せている下男により、攻撃される仕組みになっている。落下自体では大した痛手は負わないが、入り口の仕掛け賽銭箱に続いて落ちることにより、敵の不安感をあおる目的もあったという。
本堂裏隠し階段
物置の戸を開けて床板をまくると、階段があり外へ逃げることができる。床下は広く造られており、大人一人が余裕で立てる高さがある。外から堂内に逃げ込む際には、床板に溝が刻まれ敷居となっているため、引き戸を閉めることで“自動ロック”がかかり開かない仕組みになっている[3]。
巨大な梁
自然に歪曲した木を梁として使っている。雪の重みを分散するためで、北陸の豪雪に耐えるための仕組みといえる。
中二階隠し拝殿
本堂右手上にある拝殿。当時の前田家の参拝には、月に数度日を決め人払いをして行う公式参拝と、場内で不吉なことや痛ましいことが起きた際に行われる非公式参拝の二種があった。偶発的な非公式参拝では人払いがなされず、一般庶民が武士の参詣に居合わせてしまうことになる。身分の違う者同士が一緒に参拝を行うのは禁じられていたが、参詣者を強制退去させることも宗教上好ましくなく、武士側が隠し拝殿に下がるという方策がとられた。本堂奥の細い吊階段（現在は固定）から廊下を通って上がる部屋で、中二階八畳敷。正面嵌められた四枚の小障子のうち一枚が開けきりとなっていて、中央の赤い大座布団に座った武士はその30cmあまりの隙間から本尊を拝んだという。
武者隠し
隠し拝殿への階段の手前、本堂本尊右手の部屋。簀子貼りの襖四枚がしつらえてあり、明るい本堂からは中が伺いにくく逆に中から明るい本堂が見渡せるようになっていた。
切腹の間
二階と三階の間、武者溜りから茶の準備室へ上がる隠し階段の途中にある。「片どんでん返し」になっており、内側からは開けられない仕組みになっている。
非常時には自害し、火を放つための部屋だといわれている。部屋の広さは死を表す4畳。
所在地・アクセス
住所
〒921-8639 石川県金沢市野町1-2-12
交通
JR北陸新幹線・北陸本線・IRいしかわ鉄道 金沢駅下車 - 北陸鉄道バス 広小路バス停下車 - 徒歩2分
北陸鉄道石川線 野町駅下車 - 徒歩9分
駐車場
極楽寺駐車場利用（有料）
見学
開門時間：9時 - 16時（要予約）
拝観料：大人（中学生以上） 1200円、小学生 800円[6]
小学校低学年は年齢確認ができる保険証やパスポートなどの公的な証明証が必須[7]。
英語には文書で対応しており、外国人も拝観可能。
          </p>
        )}
      </div>

      {/* 地図画像を画面の下に追加 */}
      <div style={{ marginTop: "20px" }}>
        <img
          src="/images/myouenji.jpg"
          alt="地図"
          style={{ width: "100%", maxHeight: "300px", objectFit: "cover" }}
        />
      </div>
    </div>
  );
};

export default TourCompletion;
